// Reemplaza las funciones de storage por llamadas a la API
const API_URL = import.meta.env.PROD ? '/api' : 'http://localhost:3001/api';

// Cargar equipos
const loadData = async () => {
  try {
    const response = await fetch(`${API_URL}/equipos`);
    const data = await response.json();
    const equiposObj = {};
    data.forEach(eq => {
      equiposObj[eq.numero] = eq;
    });
    setEquipos(equiposObj);
  } catch (error) {
    console.error('Error al cargar:', error);
  } finally {
    setLoading(false);
  }
};

// Registrar entrada
const registrarEntrada = async (estado) => {
  if (!userName.trim()) {
    alert('Por favor ingresa tu nombre');
    return;
  }

  try {
    const response = await fetch(`${API_URL}/equipos/${selectedEquipo}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        usuario: userName,
        estado: estado,
        problema: estado === 'amarillo' ? reporteProblema : ''
      })
    });
    
    const newEquipo = await response.json();
    setEquipos(prev => ({ ...prev, [selectedEquipo]: newEquipo }));
    setShowModal(false);
  } catch (error) {
    console.error('Error:', error);
    alert('Error al registrar');
  }
};